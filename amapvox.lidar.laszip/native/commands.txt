#
# Working directory: LASzipJNA root folder
# Content: 
#   build/ CMAKE build folder (empty)
#   CMakeLists.txt CMAKE configuration file
#   commands.txt 
#   src/ JLAS_API source folder
#

# Retrieve LAStools sources

git clone https://github.com/LAStools/LAStools.git native/LAStools

#
# GNU/G++
#

cd ./native

# delete previous builds
rm -rf build/linux64/*

# create makefiles
cmake -G "Unix Makefiles" -B build/linux64

# compile target and install it in JLas project
cmake --build build/linux64 --target install --config Release

# clean target
cmake --build build/linux64 --target clean

#
# MSVC
#

# x64
# from "x64 Native Tools Command Prompt for VS 2019"
# vcvars64.bat
cd native
cmake -G "Visual Studio 16 2019" -A x64 -B build\win64
cmake --build build\win64 --config Release
# Copy build\win64\Release\RiVLibJNI.dll to ..\src\main\resources\
cmake --build build\win64 --target clean

dumpbin.exe /EXPORTS native\build\win64\Release\JLasApi.dll

